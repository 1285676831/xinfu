<!DOCTYPE html>
<html>
<head>
${inc:/action/project/fitness/home/pub}
<title>会员/资源团体</title>
</head>
<body>
	<!-- 添加场地 -->
	<div class="modal" id="modalAddnew" tabindex="-1">
		<div class="basic-information modal-dialog dialogbg">
			<header class="header-default">
				<span id="formTitle">新增</span>
				<span class="header-close"></span>
			</header>
			<form id="formEditor" name="formEditor" class="form-horizontal" role="form" method="post">
                <input type="hidden" id="code" name="code" value="" />
          		<div class="modal-body b-i-main">
					<nav class="tab-nav-my">
						<li>
							<label style="margin-left: -250px;width: 150px;">团体名称：</label>
							<input type="text" id="groupname" name="groupname" value="" maxlength="80" placeholder="团体名称" />
						</li>
					</nav>
				</div>
				<footer class="footer-default">
					<button type="button" id="save_btn">保存</button>
				</footer>
			</form>
		</div>
	</div>
	
	<form role="form" method="post" id="searchForm">
		<input name="sort" type="hidden" value="created"preserve="true" />
		<input name="order"type="hidden" value="desc" preserve="true" />
		<input name="pageNo" type="hidden" value="" preserve="true" /> 
		<input name="totalPages" type="hidden" value="" preserve="true" />
		<div class="r-tab-cont">
			<div class="c-n-nav-2 am-tab-panel am-in am-active am-fade three-none" >
				<div class="r-tab-cout-3-t">
					<div class="r-tab-cout-3-t-t swgl-tk">
						<nav>
							<li class="inputName">
						  		<input id="searchgroupname" name="searchgroupname" type="text" placeholder="团体名称" class="input-default"/>
							</li>
							<div>
								<button type="button" class="r-c-3-btn-1" id="search_btn" title="查询"></button>
								<img src="${def:context}/js/project/fitness/image/SVG/nav/xinzengkecheng.svg" title="添加" alt="" data-toggle="modal" id="addnew_btn">
							</div>
						</nav>
					</div>
					<div class="r-tab-cout-3-t-b">
						<nav class="r-c-3-t-b-l">
						</nav>
						<nav class="r-c-3-t-b-r">
							<li>
								<img style="    width: 80px;
								height: 30px;" src="${def:context}/js/project/fitness/image/SVG/table/tuanticy.svg" alt="" id="guest_group_member" title="会员/资源团体成员">
							</li>
							<li>
								<img src="${def:context}/js/project/fitness/image/SVG/table/icon_yulan.svg" alt="" id="see" title="查看">
							</li>
							<li>
								<img src="${def:context}/js/project/fitness/image/SVG/nav/xiugai.svg" alt="" id="edit_btn" title="修改">
							</li>
							<li>
								<img src="${def:context}/js/project/fitness/image/SVG/nav/shanchu.svg" alt=""id="delete_btn" title="删除">
							</li>
						</nav>
					</div>
				</div>		
			</div>
			<div class="r-tab-cout-3-b">
				<div class="to-change-background"></div>
					<table class="">
						<thead>
							<tr>
								<th>
									<input type="checkbox" name="checkall" id="checkall" style="display: none;"/>
								</th>
								<th>团体名称</th>
							</tr>
						</thead>
						<tbody id="datagridTemplate" style="display: none">
							<tr>
				                <td>#checklink#</td>
				                <td>#groupname#</td>
							</tr>
						</tbody>
						<tbody id="datagrid">
						</tbody>
					</table>
				<div class="pageDiv">
					<ul class="pagination">
					</ul>
				</div>
			</div>
		</div>
	</form>
	<form action="${def:context}${def:actionroot}/excel" role="form" method="post" id="daochuForm" target="_blank" style="display: none">
			<input id="daochu_searchgroupname" name="daochu_searchgroupname" type="text" />
	</form>
	<input type="hidden" name="actionroot" id="actionroot" value="${def:actionroot}" />
<script language="JavaScript">
var search=null;
$(document).ready(function() {
	var obj = $Crud({
		formId:"formEditor",
		button:"save_btn",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
		bpkField:"code",
		insertBack:function(){
			search.searchData();
		},
		updateBack:function(){
			search.searchData();
		},
		deleteBack:function(){
			search.searchData();
		},
		addNewBack:function(){
			$("#save_btn").show();
			$("#formTitle").html("新增");
		},
		editBack:function(){
			$("#formTitle").html("修改");
		},
		validate:function(){
			var flag=$("#formEditor").validate({
				rules : {
				},
				messages: {
				}
				
			});
			return flag;
		},
		check:function(){
			return true;
		}
	}).init();
	this.search=search;
	search=$Search({datagrid:"datagrid",formId:"searchForm",success:function(){
		ccms.util.renderCheckbox("groupcheckbox");
		//修改
		$("#edit_btn").unbind().on("click", function(){
			$("#save_btn").show();
			var obthis = getCheckboxValue("groupcheckbox");
			var count = obthis.split(",").length;
			if(obthis!= ""){
				if(count>1){
					ccms.dialog.notice("只能选择1条记录!");
				}else{
					obj.edit({code:obthis});
				}
			}else{
				ccms.dialog.notice("请选择!");
			}
		});
		//团体成员
		$("#guest_group_member").unbind().on("click", function(){
			$("#save_btn").show();
			var obthis = getCheckboxValue("groupcheckbox");
			var count = obthis.split(",").length;
			if(obthis!= ""){
				if(count>1){
					ccms.dialog.notice("只能选择1条记录!");
				}else{
					ccms.dialog.open({url : "${def:context}${def:actionroot}/guestgroupmember/crud?groupid="+obthis, height: 600});
				}
			}else{
				ccms.dialog.notice("请选择!");
			}
		});
		//查看
		$("#see").unbind().on("click", function(){
			var obthis = getCheckboxValue("groupcheckbox");
			var count = obthis.split(",").length;
			if(obthis!= ""){
				if(count>1){
					ccms.dialog.notice("只能选择1条记录!");
				}else{
					obj.edit({code:obthis});
					$("#save_btn").hide();
				}
			}else{
				ccms.dialog.notice("请选择!");
			}
		});
		//删除
		$("#delete_btn").unbind().on("click", function(){
			var obthis = getCheckboxValue("groupcheckbox");
			var count = obthis.split(",").length;
			if(obthis!= ""){
				$Dialog().confirm("确定要删除该数据吗?", function(){
					obj.del({code:obthis});
				});
			}else{
				ccms.dialog.notice("请选择!");
			}
		});
	}}).initSearchBtn().searchData(1);
	//导出
	$("#daochu_list").unbind().on("click", function(){
         $("#daochu_searchgroupname").val($("#searchgroupname").val());
         $("#daochuForm").submit();
    });	
	//全选   取消全选
    $("#checkall").unbind().on("ifClicked",function(){    //点击事件未选中
		 if( $(this).prop("checked") ){// 
			$('input[name=groupcheckbox]').iCheck('uncheck');
		 }else{
			$('input[name=groupcheckbox]').iCheck('check');  //
		 }
    });
	$(".header-close").unbind().on("click",function(){
		$("#modalAddnew").modal('hide');
		ccms.util.clearForm('formEditor');
	});
	
	
});
</script>
</body>
</html>